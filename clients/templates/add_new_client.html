{% extends 'admin_base.html' %}

{% block content %}

<div class="container red lighten-2" style="padding:20px; margin-top: 20px;">
    <div class="row ">
        <h2><i class="material-icons" style="font-size:42px;">add_circle</i> Book cleint for test drive </h2><hr>
        <h6><strong>Please, enter registration number of car you want to book appointment for.</strong></h6>
        <form class="col s12" action="{{url_for('client_blueprint.find_reg_num_for_client')}}" method="POST">
            <div class="row">
                <div class="input-field col s12">
                    <input class="m-3" type="text" id="reg_num" name="reg_num" required>
                    <label class="m-3" for="email">Car registration number</label>
                </div>
                <div class="input-field col s12">
                    <button class="waves-effect waves-light btn" type="submit"><i class="material-icons left">search</i>Find car</button>
                </div>
            </div>
        </form> 
    </div>
    <div class="row">
{% with messages = get_flashed_messages(category_filter=["client_appiontment_message"]) %}
{% if messages %} 
    {%- for msg in messages %}
    <p class="lead">{{ msg }}</p>
    {% endfor -%}
{% endif %}
{% endwith %}

</div>
</div>
<!--If admin car is going to be in search result this section will come back-->
{% if car_clients_intrest %}
<div class="container">
    <div class="row">
        <div class="col s12">
        <h3>Cleint registration form</h3>
        </div>
    </div>
<!--Collapsible are here-->
    <div class="row">
        <div class="col s12">
            <ul class="collapsible ">
                <li>
                <div class="collapsible-header">
                    <i class="material-icons right"> keyboard_arrow_down</i> 
                    <i class="fas fa-car-side" style="margin-left:5px;"></i>
                    {{car_clients_intrest.car_make}} {{car_clients_intrest.car_model}}, Registration number {{car_clients_intrest.reg_num}}
                </div>
                <div class="collapsible-body center-align">
                <span><img class="activator" src="{{ car_clients_intrest.car_image_url }}"></span>
                </div>
                </li>
                <!--If there are any other appiontments on car-->
                {% if other_appiontments.count() > 0 %}
                <li>
                <div class="collapsible-header">
                <i class="material-icons right">keyboard_arrow_down</i><i class="material-icons">info</i>{{other_appiontments.count() }}
                more appiontments on {{car_clients_intrest.reg_num}}
                </div>

                <div class="collapsible-body">
                     <div class="row valign-wrapper">
                        {% for appiontment in other_appiontments %}
                        <div class="col teal s4 center-align" style="margin:2px">
                            <p>Client name: {{appiontment.full_name}} </p>
                            <p>Cleint phone: {{appiontment.phone}}  </p>
                            <p>Appiontment date: {{appiontment.appiontment_date}}</p>
                            <p>Appiontment time: {{appiontment.appiontment_time}} </p>
                        </div>
                        {% endfor %}
                     </div>
                </div>
                </li>
                {% endif %}
            </ul>
        </div>
    </div>
    <div class="row">
    <form class="col s12" action="{{url_for('client_blueprint.admin_make_appiontment')}}" method="POST">
        <input type="hidden" name="dashboard_status" value="true">
        <input type="hidden" name="car_make" value="{{car_clients_intrest.car_make}}">
        <input type="hidden" name="car_model" value="{{car_clients_intrest.car_model}}">
        <input type="hidden" name="reg_num" value="{{car_clients_intrest.reg_num}}">
        <input type="hidden" name="registration_year" value="{{car_clients_intrest.registration_year}}">
        <input type="hidden" name="car_image_url" value="{{car_clients_intrest.car_image_url}}">
  
        <div class="input-field col s12">
            <i class="material-icons prefix">account_circle</i>
            <input type="text" class="form-control" id="full_name" name="full_name" placeholder="full name" required>
            <label for="exampleInputEmail1">Full name</label>
        </div>
        <div class="input-field col s12">
            <i class="material-icons prefix">email</i>
            <input type="email" class="validate" id="email" name="email" placeholder="email" required>
            <label for="email">Email <address></address></label>
        </div>
        <div class="input-field col s12">
            <i class="material-icons prefix">phone</i>
            <input type="tel" class="validate" id="phone" name="phone" placeholder="phone number" required>
            <label  for="phone">Telephone number</label>
        </div>
        <div class="input-field col s12">
            <i class="material-icons prefix">timer</i>
            <input class="validate ml-5" type="time" name="appiontment_time" required>
            <label   for="best_time_to_contact">Appiontment time</label>
        </div>
        <div class="input-field col s12">
            <i class="material-icons prefix">date_range</i>
            <input class="validate ml-5" type="date" id="start" name="appiontment_date" value="2018-07-22" min="2020-01-01" max="2022-12-31" required>
            <label class="ml-5" for="start">Appiontment date:</label>
        </div>
        <div class="input-field col s12">
            <i class="material-icons prefix">mode_edit</i>
            <textarea id="textarea1" class="materialize-textarea" name="client_related_notes" rows="3"></textarea>
            <label for="textarea1">Textarea</label>
        </div>
        <div class="input-field col s12">
            <button type="submit" class="btn btn-primary">Book appiontment</button>
        </div>
    </form>
    </div>
</div>
{% endif %}

 {%endblock%}
